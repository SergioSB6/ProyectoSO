DROP DATABASE IF EXISTS M2JUEGO;
CREATE DATABASE M2JUEGO; 
USE M2JUEGO;



CREATE TABLE JUGADORES (
  
  ID INT NOT NULL,
  Usuario VARCHAR(20),
  Contrasena VARCHAR(20),
  



PRIMARY KEY (ID)


)ENGINE=InnoDB;



 
CREATE TABLE PARTIDAS (
  
   ID INT NOT NULL,
   Fecha_Hora VARCHAR (50),
   Duracion INT,
   Ganador VARCHAR (50),

PRIMARY KEY (ID)

)ENGINE=InnoDB;




CREATE TABLE PARTICIPACION  (
  
   ID_J INT,
   ID_P INT,
 
  FOREIGN KEY (ID_J) REFERENCES JUGADORES (ID),
  FOREIGN KEY (ID_P) REFERENCES  PARTIDAS(ID)


)ENGINE=InnoDB;



INSERT INTO JUGADORES VALUES (1, 'Caty', '1234D');
INSERT INTO JUGADORES VALUES (2, 'Mohamed', '1334S');
INSERT INTO JUGADORES VALUES (3, 'Sergio', '6784E');
INSERT INTO JUGADORES VALUES (4, 'Gerard', '9776T');
 



INSERT INTO PARTIDAS VALUES (1, '01/01/2020_12:45:35', 10, 'Gerard');
INSERT INTO PARTIDAS VALUES (2, '02/01/2020_13:45:35', 5, 'Caty');
INSERT INTO PARTIDAS VALUES (3, '03/01/2020_14:45:35', 17, 'Gerard ');
INSERT INTO PARTIDAS VALUES (4, '04/01/2020_15:45:35', 20, 'Gerard');




INSERT INTO PARTICIPACION VALUES (1, 2);
INSERT INTO PARTICIPACION VALUES (4, 1);
INSERT INTO PARTICIPACION VALUES (3, 2);
INSERT INTO PARTICIPACION VALUES (4, 3);
INSERT INTO PARTICIPACION VALUES (4, 4);
INSERT INTO PARTICIPACION VALUES (3, 1);
INSERT INTO PARTICIPACION VALUES (2, 3);
INSERT INTO PARTICIPACION VALUES (2, 4);


 

SELECT PARTIDAS.ID FROM (PARTIDAS, JUGADORES, PARTICIPACION) 
WHERE  PARTIDAS.Ganador = 'Gerard'
AND    JUGADORES.ID = PARTICIPACION.ID_J
AND    PARTIDAS.ID = PARTICIPACION.ID_P
AND    PARTICIPACION.ID_P = SELECT JUGADORES.ID FROM JUGADORES WHERE JUGADORES.Usuario = 'Gerard';






SELECT PARTIDAS.Ganador FROM (PARTIDAS, JUGADORES, PARTICIPACION) 
WHERE  PARTIDAS.Duracion >= 10
AND    JUGADORES.ID = PARTICIPACION.ID_J
AND    PARTIDAS.ID = PARTICIPACION.ID_P;




SELECT PARTIDAS.Fecha_Hora FROM (PARTIDAS, JUGADORES, PARTICIPACION) 
WHERE  PARTIDAS.ID = 4
AND    JUGADORES.ID = PARTICIPACION.ID_J
AND    PARTIDAS.ID = PARTICIPACION.ID_P;


SELECT PARTIDAS.Ganador FROM (PARTIDAS, JUGADORES, PARTICIPACION) 
WHERE  SUBSTRING(PARTIDAS.Fecha_Hora, 1, 10)  = '02/01/2020'
AND    JUGADORES.ID = PARTICIPACION.ID_J
AND    PARTIDAS.ID = PARTICIPACION.ID_P;



